<!DOCTYPE html>
<html>
<head>
  <title>CSV Modifier</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
</head>
<body>
  <h3>Upload CSV to swap columns M & N and remove F & G</h3>
  <input type="file" id="csvFile" accept=".csv" />
  <button id="downloadBtn" disabled>Download Modified CSV</button>

  <script>
    let modifiedCsv = "";

    document.getElementById("csvFile").addEventListener("change", function (e) {
      const file = e.target.files[0];
      if (!file) return;

      Papa.parse(file, {
        complete: function (results) {
          const rows = results.data;

          const modified = rows.map(row => {
            if (row.length >= 14) {
              // Swap M (index 12) and N (index 13)
              [row[12], row[13]] = [row[13], row[12]];
            }
            if (row.length >= 7) {
              // Remove G (index 6) first, then F (index 5)
              row.splice(6, 1);
              row.splice(5, 1);
            }
            return row;
          });

          modifiedCsv = Papa.unparse(modified);
          document.getElementById("downloadBtn").disabled = false;
        }
      });
    });

    document.getElementById("downloadBtn").addEventListener("click", function () {
      const blob = new Blob([modifiedCsv], { type: "text/csv;charset=utf-8;" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "modified.csv";
      link.click();
    });
  </script>
</body>
</html>
